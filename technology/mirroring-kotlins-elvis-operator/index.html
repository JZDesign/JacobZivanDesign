<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Jacob Zivan Design"/><link rel="canonical" href="https://JacobZivanDesign.com/technology/mirroring-kotlins-elvis-operator"/><meta name="twitter:url" content="https://JacobZivanDesign.com/technology/mirroring-kotlins-elvis-operator"/><meta name="og:url" content="https://JacobZivanDesign.com/technology/mirroring-kotlins-elvis-operator"/><title>Mirroring Kotlin's Elvis Operator in Swift | Jacob Zivan Design</title><meta name="twitter:title" content="Mirroring Kotlin's Elvis Operator in Swift | Jacob Zivan Design"/><meta name="og:title" content="Mirroring Kotlin's Elvis Operator in Swift | Jacob Zivan Design"/><meta name="description" content="Unwrap or Throw - Make Swift's equivalent to Kotlin's Elvis Operator!  A Tutorial for adding Custom Operators in Swift."/><meta name="twitter:description" content="Unwrap or Throw - Make Swift's equivalent to Kotlin's Elvis Operator!  A Tutorial for adding Custom Operators in Swift."/><meta name="og:description" content="Unwrap or Throw - Make Swift's equivalent to Kotlin's Elvis Operator!  A Tutorial for adding Custom Operators in Swift."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Jacob Zivan Design"/><meta name="twitter:image" content="https://JacobZivanDesign.com/images/social.jpg"/><meta name="og:image" content="https://JacobZivanDesign.com/images/social.jpg"/></head><body class="item-page"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({ startOnLoad: true });</script><!--ITEM HTML--><header><div class="wrapper"><a class="site-icon" href="/"><img src="/images/memoji.png" alt="Memoji of Jacob giving a thumbs up"/></a><nav><ul><li><a class="selected" href="/technology">Technology</a></li><li><a href="/foresight">Foresight</a></li></ul></nav></div></header><div class="wrapper"><article><div class="content"><h1>Mirroring Kotlin's Elvis Operator in Swift</h1><p>In many languages, there are ways to coalesce <code>nil</code> values. In Swift, for example, the Nil Coalescing operator is <code>??</code> We use this to provide a fallback value when a variable could be <code>nil</code>, like so:</p><pre><code><span class="keyword">var</span> y: <span class="type">Int</span>? = <span class="keyword">nil
var</span> x = y ?? <span class="number">0</span>
</code></pre><p>In the Kotlin language, there is a similar operator called the "Elvis Operator" <em>because, seriously... it looks a bit like a tiny sideways elvis</em> <code>?:</code> It's used like:</p><pre><code>x = y ?: <span class="number">0</span>
</code></pre><br/><h2>So why try and mirror it?</h2><p>Unlike Swift's <code>??</code>, Kotlin's <code>?:</code> does more than coalesce nil values, it can throw too!</p><pre><code>x = y ?: <span class="keyword">throw</span> <span class="type">SomeException</span>()
</code></pre><p>When used this way, <code>x</code> will still be a non-optional type, but the function will stop there if <code>y</code> is <code>null</code>.</p><p>To do this in Swift, we would generally need to use a <code>guard</code> statement.</p><pre><code><span class="keyword">guard let</span> x = y <span class="keyword">else</span> { 
    <span class="keyword">throw</span> <span class="type">SomeError</span>() 
}
</code></pre><p>It's not terrible, but Kotlin's <code>?:</code> is much nicer, <em>in my opinion.</em></p><br/><h2>Writing a Custom Operator in Swift</h2><p>Swift allows us to write <a href="https://docs.swift.org/swift-book/LanguageGuide/AdvancedOperators.html#ID46">custom operators</a> to handle things like this. Unfortunately, the <code>:</code> character is <a href="https://docs.swift.org/swift-book/ReferenceManual/LexicalStructure.html#ID418">unavailable</a> for use. So we can't make our operator syntactically identical to Kotlin's.</p><p>The operator we'll be creating is an infix operator. Meaning that the operator will fall <strong>in</strong>between its arguments, just like <code>argument1 ?? argument2</code>. In Swift, infix operators must adhere to a <a href="https://developer.apple.com/documentation/swift/swift_standard_library/operator_declarations">Precedence Group</a>. This grouping tells the compiler what order functions should get executed, much like the <a href="https://en.wikipedia.org/wiki/Order_of_operations">Order of Operations</a> in mathematics.</p><p>There is a lot there, so we won't go into the specifics on all of that in this tutorial.</p><br/><h3>Unwrap or Throw</h3><br/><p>Because we can't use Kotlin's <code>?:</code> or Swift's <code>??</code> we'll do something a little different.</p><pre><code>infix operator ??? : <span class="type">TernaryPrecedence</span>
<span class="keyword">func</span> ???&lt;<span class="type">T</span>&gt;(<span class="keyword">_</span> left: <span class="type">Optional</span>&lt;<span class="type">T</span>&gt;, right: <span class="type">Error</span>) <span class="keyword">throws</span> -&gt; <span class="type">T</span> {
    <span class="keyword">guard let</span> value = left <span class="keyword">else</span> { <span class="keyword">throw</span> right }
    <span class="keyword">return</span> value
}
</code></pre><br/><p>Using generics, we can pass any optional type to the left hand side of <code>???</code> for evaluation! Let's take a look at how it's used.</p><pre><code>x = <span class="keyword">try</span> y ??? <span class="type">SomeError</span>()
</code></pre><br/><p>It works splendidly! Because of the way Swift handles throwing functions, we do this differently than in Kotlin. <code>try</code> on the left instead of <code>throw</code> on the right.</p><p>Unlike Kotlin's Elvis Operator, this does not handle both coalescing a <code>nil</code> value and throwing errors. We'll have 2, <code>??</code> and <code>???</code>, and we'll need to use the them appropriately.</p><p>I hope you found this useful!</p></div><span>Tags: </span><ul class="tag-list"><li><a href="/tags/kotlin">Kotlin</a></li><li><a href="/tags/ios">iOS</a></li><li><a href="/tags/swift">Swift</a></li><li><a href="/tags/technology">Technology</a></li><li><a href="/tags/tutorial">Tutorial</a></li></ul></article></div><footer><br/><div class="center">
    <p><sm>
    If you enjoy the content on my site and want to support my writing, you can donate <a href="https://ko-fi.com/jacobzivandesign" target="blank">here</a> or <a href="https://github.com/sponsors/JZDesign" target="blank">here.</a>
    </p></sm>
    <p><sm>
    Or if you're a <a href="https://wallet.proton.me" target="blank">Proton Wallet</a> user, you can send coin to donate@jacobzivandesign.com
    </p></sm>
</div><br/><br/><p class="jbmono">Code typeface == <a href="https://www.jetbrains.com/lp/mono/">JetBrains Mono</a></p><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p><p><a href="/feed.rss">RSS feed</a></p><div class="social"><a target="_blank" class="find-me" href="https://github.com/JZDesign/"><img src="/images/git.svg"/></a><a target="_blank" class="find-me" href="https://bsky.app/profile/jacobzivandesign.bsky.social"><img src="/images/bsky.svg"/></a><a target="_blank" class="find-me" href="https://x.com/JZivanDesign"><img src="/images/x-logo.svg"/></a><a target="_blank" class="find-me" href="https://mastodon.social/@jacobzivandesign"><img src="/images/mastodon.svg"/></a><a target="_blank" class="find-me" href="https://www.linkedin.com/in/jacob-rakidzich-b8722436/"><img src="/images/linkedin.svg"/></a></div><br/></footer></body></html>